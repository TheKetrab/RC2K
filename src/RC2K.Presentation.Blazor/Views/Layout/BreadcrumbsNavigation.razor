@inherits LayoutComponentBase
@inject NavigationManager Navigation
@using RC2K.Presentation.Blazor.ViewModels
@using RC2K.Presentation.Blazor.Views.Components;
@using BreadcrumbLink = RC2K.Presentation.Blazor.ViewModels.BreadcrumbLink;
<Breadcrumbs Links="@breadcrumbLinks" />

@code{
    private List<BreadcrumbLink> breadcrumbLinks = [];

    protected override void OnParametersSet() 
    {
        breadcrumbLinks.Add(new BreadcrumbLink
        {
            Address = Navigation.BaseUri,
            IsActive = Navigation.Uri == Navigation.BaseUri,
            OrderIndex = 1,
            Title = "home"
        });

        string[] path = new Uri(Navigation.Uri).LocalPath
            .Split('/',StringSplitOptions.RemoveEmptyEntries);

        for (int i=0; i<path.Length; i++)
        {
            string link = path[i];
            BreadcrumbLink lastLink = breadcrumbLinks.Last();
            breadcrumbLinks.Add(new BreadcrumbLink
                {
                    Address = Path.Combine(lastLink.Address,link),
                    IsActive = link == path.Last(),
                    OrderIndex = i + 1,
                    Title = link
                });
        }
        base.OnParametersSet();
    }
}